(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),l=n.n(c),o=n(12),u=n.n(o),i=n(10),s=n(18),m=n(154),f=n(118),p=n(158),d=n(119),E=n(159),b=n(160),v=n(161),g=n(162),h=function(){var e=Object(i.c)((function(e){return e.blogs}));return e.length<1?l.a.createElement("h3",null,"No blogs atm... :/"):l.a.createElement(m.a,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:3},l.a.createElement(m.a,{container:!0,alignItems:"center",justify:"center",spacing:3},l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{variant:"h2"},"Blogs"))),l.a.createElement(m.a,null,l.a.createElement(p.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(b.a,null,e.sort((function(e,t){return t.likes-e.likes})).map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,null,l.a.createElement(s.b,{to:"/blogs/".concat(e.id)},e.title," ")),l.a.createElement(g.a,null,e.author))})))))))},O=n(9),y=n.n(O),w=n(15),j=n(27),k=n.n(j),S={login:function(){var e=Object(w.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=null,I={getAll:function(){return k.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(w.a)(y.a.mark((function e(t){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,k.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return k.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){x="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:x}};return k.a.delete("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},resetToken:function(){return x=null},getComments:function(){var e=Object(w.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("".concat("/api/blogs","/all/comments"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postComment:function(){var e=Object(w.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("".concat("/api/blogs","/").concat(n,"/comments"),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},T=function(e,t,n,r){e({type:"ADD_MESSAGE",data:{message:t,severity:r||"success"}}),clearTimeout(a),a=setTimeout((function(){e({type:"CLEAR_MESSAGE"})}),1e3*(n||5))},C=function(e){return function(){var t=Object(w.a)(y.a.mark((function t(n){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.login(e);case 3:a=t.sent,window.localStorage.setItem("loggedUser",JSON.stringify(a)),I.setToken(a.token),n({type:"LOGIN",data:a}),T(n,"welcome ".concat(a.name,"!")),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),T(n,"connection error while trying to login",5,"warning");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},_=n(163),A=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.login.name}));return l.a.createElement("em",null,t," logged in ",l.a.createElement(_.a,{variant:"outlined",color:"inherit",onClick:function(){e((function(e){window.localStorage.removeItem("loggedUser"),I.resetToken(),e({type:"LOGOUT"})}))}},"logout"))},G=n(22),N=function(e,t,n){return function(a){a({type:"ADD_MESSAGE",data:{message:e,severity:n||"success"}}),clearTimeout(r),r=setTimeout((function(){a({type:"CLEAR_MESSAGE"})}),1e3*(t||5))}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_MESSAGE":return t.data;case"CLEAR_MESSAGE":return null;default:return e}},D=(n(7),n(164)),B=function(e){var t=Object(c.useState)(""),n=Object(G.a)(t,2),a=n[0],r=n[1];return{type:e,value:a,onChange:function(e){r(e.target.value)},onSubmit:function(){return r("")}}},R=n(180),U=n(166),P=n(167),q=n(177),J=n(169),z=function(){var e=Object(i.b)(),t=B("text"),n=B("password"),a=Object(c.useState)(!1),r=Object(G.a)(a,2),o=r[0],u=r[1],s=function(){var a=Object(w.a)(y.a.mark((function a(r){return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r.preventDefault();try{e(C({username:t.value,password:n.value})),t.onSubmit(),n.onSubmit()}catch(c){console.log(c),e(N("wrong username or password",5))}case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return l.a.createElement("div",null,l.a.createElement(_.a,{variant:"outlined",color:"inherit",onClick:function(){u(!0)}},"Login"),l.a.createElement(R.a,{open:o,onClose:function(){u(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(U.a,{id:"form-dialog-title"},"Login"),l.a.createElement(P.a,null,l.a.createElement("form",{onSubmit:s},l.a.createElement("div",null,l.a.createElement(q.a,{label:"username",inputProps:t,required:!0})),l.a.createElement("div",null,l.a.createElement(q.a,{label:"password",inputProps:n,required:!0})),l.a.createElement(J.a,null,l.a.createElement(_.a,{variant:"contained",id:"login-button",type:"submit"},"login"))))))},K=n(52),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return e.concat(t.data);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?t.data:e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));default:return e}},Y=function(){return k.a.get("/api/users").then((function(e){return e.data}))},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;case"UPDATE_USER_BLOGS":return e.map((function(e){return e.username===t.username?Object(K.a)({},e,{blogs:e.blogs.concat(t.blog)}):e}));default:return e}},H=n(181),Q=n(33),V=function(){var e=Object(i.b)(),t=Object(Q.f)(),n=Object(i.c)((function(e){return e.login})),a=B("text"),r=B("text"),o=B("url"),u=Object(c.useState)(!1),s=Object(G.a)(u,2),m=s[0],f=s[1];return n?l.a.createElement("div",null,l.a.createElement(_.a,{color:"inherit",onClick:function(){return f(!0)}},"Create blog"),l.a.createElement(R.a,{open:m,onClose:function(){return f(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(U.a,{id:"form-dialog-title"},"Create blog"),l.a.createElement(P.a,null,l.a.createElement("form",{className:"formDiv",onSubmit:function(c){c.preventDefault();var l,u,i={title:a.value,author:r.value,url:o.value};e(function(e,t){return function(){var n=Object(w.a)(y.a.mark((function n(a){var r;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.create(e);case 3:r=n.sent,a({type:"CREATE_BLOG",data:r}),T(a,"a new blog ".concat(r.title," by ").concat(r.author," added")),t.push("/blogs/".concat(r.id)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),T(a,"an error occured while posting blog ".concat(e.title),5,"error");case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()}(i,t)),e((l=n,u=i,function(e){e({type:"UPDATE_USER_BLOGS",data:u,username:l})})),f(!1)}},l.a.createElement("div",null,l.a.createElement(q.a,{label:"title",inputProps:a,required:!0})),l.a.createElement("div",null,l.a.createElement(q.a,{label:"author",inputProps:r,required:!0})),l.a.createElement("div",null,l.a.createElement(q.a,{label:"url",inputProps:o,required:!0})),l.a.createElement(J.a,null,l.a.createElement(_.a,{id:"blogSubmitButton",type:"submit"},"submit")))))):l.a.createElement(H.a,{title:"you must first login to create blogs"},l.a.createElement("span",null,l.a.createElement(_.a,{color:"inherit",onClick:function(){return e(N("login is required to create blogs",10,"info"))},disabled:!0},"Create blog")))},X=n(170),Z=n(171),$=function(){var e=Object(i.c)((function(e){return e.login})),t=Object(D.a)((function(e){return{toolbar:e.mixins.toolbar}}))();return l.a.createElement("div",null,l.a.createElement("div",{className:t.toolbar}),l.a.createElement("div",{className:t.toolbar}),l.a.createElement(X.a,{position:"fixed"},l.a.createElement(Z.a,null,l.a.createElement(_.a,{color:"inherit",component:s.b,to:"/blogs"},"blogs"),l.a.createElement(V,null),l.a.createElement(_.a,{color:"inherit",component:s.b,to:"/users"},"users"),e?l.a.createElement(A,null):l.a.createElement(z,null))))},ee=function(){var e=Object(Q.g)().id,t=Object(i.c)((function(e){return e.users})).find((function(t){return t.id===e}));return t?l.a.createElement(m.a,{alignItems:"stretch",justify:"center",container:!0,direction:"column",spacing:3},l.a.createElement(m.a,{alignItems:"center",container:!0,justify:"center",direction:"column"},l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{variant:"h2"},t.name)),l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{variant:"h4"},"added blogs"))),l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(b.a,null,t.blogs.map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,null,l.a.createElement(s.b,{to:"/blogs/".concat(e.id)},e.title," ")),l.a.createElement(g.a,null,l.a.createElement(f.a,null,e.likes," likes")))}))))))):null},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_COMMENTS":return t.comments;case"POST_COMMENT":return e.concat(t.comment);default:return e}},ne=function(e){var t=e.blog,n=B("text"),a=Object(i.c)((function(e){return e.comments.filter((function(e){return e.blogId===t.id}))})),r=Object(i.b)();return l.a.createElement("div",null,l.a.createElement(f.a,null,a.length," comments"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault();try{var a={comment:n.value};r((c=a,l=t.id,function(){var e=Object(w.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.postComment(c,l);case 3:n=e.sent,t({type:"POST_COMMENT",comment:n}),T(t,"comment added"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),T(t,"an error occured while posting comment",5,"error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),n.onSubmit()}catch(o){console.log(o)}var c,l}},l.a.createElement(q.a,{label:"add comment",inputProps:n})),a.map((function(e){return l.a.createElement(f.a,{key:e.id},e.comment)})))},ae=n(172),re=n(175),ce=n(173),le=n(174),oe=function(){var e=Object(Q.g)().id,t=Object(i.b)(),n=Object(Q.f)(),a=Object(i.c)((function(e){return e.blogs})),r=Object(i.c)((function(e){return e.login})),c=a.find((function(t){return t.id===e}));if(!c)return null;var o=c.user[0];return l.a.createElement(ae.a,null,l.a.createElement(m.a,{container:!0,direction:"column",justify:"space-between",spacing:3},l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{variant:"h2"},c.title," ",c.author),l.a.createElement(f.a,null,"added by ",l.a.createElement(s.b,{to:"/users/".concat(o.id)},o.name," ")),l.a.createElement("a",{href:c.url},l.a.createElement(f.a,null,c.url))),l.a.createElement(m.a,{item:!0},l.a.createElement(m.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(_.a,{variant:"contained",startIcon:l.a.createElement(ce.a,null),color:"inherit",id:"blogLikeButton",onClick:function(){return t(function(e){return function(){var t=Object(w.a)(y.a.mark((function t(n){var a,r;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=Object(K.a)({},e,{likes:e.likes+1}),t.next=4,I.update(e.id,a);case 4:r=t.sent,n({type:"LIKE_BLOG",data:r}),T(n,"liked ".concat(r.title,"!")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),T(n,"an error occured while liking blog ".concat(e.title),5,"error");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(c))}},c.likes," likes"),!r||!c.user||c.user.length>0&&r.username!==o.username?l.a.createElement(H.a,{title:"only owner can delete"},l.a.createElement("span",null,l.a.createElement(_.a,{variant:"outlined",startIcon:l.a.createElement(le.a,null),disabled:!0},"Remove"))):l.a.createElement(_.a,{variant:"contained",startIcon:l.a.createElement(le.a,null),onClick:function(){window.confirm("You are about to delete ".concat(c.title," by ").concat(c.author))&&(t(function(e){return function(){var t=Object(w.a)(y.a.mark((function t(n){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I.remove(e.id);case 3:n({type:"DELETE_BLOG",data:e.id}),T(n,"".concat(e.title," deleted!")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),T(n,"an error occured when deleting ".concat(e.title),5,"error");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(c)),n.push("/blogs"))}},"Remove"))),l.a.createElement(m.a,{item:!0},l.a.createElement(re.a,{spacing:3})),l.a.createElement(m.a,{item:!0},l.a.createElement(ne,{blog:c}))))},ue=n(178),ie=n(182),se=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.notifications})),n=function(){e((function(e){e({type:"CLEAR_MESSAGE"})}))};return t?l.a.createElement(ie.a,{open:!0,onClose:n},l.a.createElement(ue.a,{onClose:n,severity:t.severity},t&&l.a.createElement("div",{className:"error"},t.message))):null},me=n(176),fe=function(){var e=Object(i.c)((function(e){return e.users}));return l.a.createElement(m.a,{alignItems:"stretch",justify:"center",container:!0,direction:"column",spacing:3},l.a.createElement(m.a,{alignItems:"center",container:!0,justify:"center",direction:"column"},l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{variant:"h2"},"Users"))),l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(me.a,null,l.a.createElement(v.a,null,l.a.createElement(g.a,null,"user"),l.a.createElement(g.a,{align:"right"},"blogs created"))),l.a.createElement(b.a,null,e.map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,{component:"th",scope:"row"},l.a.createElement(s.b,{to:"/users/".concat(e.id)},l.a.createElement(f.a,null,e.username))),l.a.createElement(g.a,{align:"right",scope:"row"},l.a.createElement(f.a,null,e.blogs.length)))})))))))},pe=function(){var e=Object(i.b)();return Object(c.useEffect)((function(){e(function(){var e=Object(w.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.getAll();case 3:n=e.sent,t({type:"INIT_BLOGS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),T(t,"couldn't load blogs from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(w.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y();case 3:n=e.sent,t({type:"INIT_USERS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),T(t,"couldn't load users from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(w.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.getComments();case 3:n=e.sent,t({type:"INIT_COMMENTS",comments:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),T(t,"couldn't load comments from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(c.useEffect)((function(){var t,n=window.localStorage.getItem("loggedUser");n&&e((t=n,function(e){var n=JSON.parse(t);I.setToken(n.token),e({type:"LOGIN",data:n})}))}),[e]),l.a.createElement(ae.a,null,l.a.createElement(s.a,null,l.a.createElement(se,null),l.a.createElement($,null),l.a.createElement(Q.c,null,l.a.createElement(Q.a,{path:"/blogs/:id"}," ",l.a.createElement(oe,null)," "),l.a.createElement(Q.a,{path:"/blogs"}," ",l.a.createElement(h,null)," "),l.a.createElement(Q.a,{path:"/users/:id"}," ",l.a.createElement(ee,null)," "),l.a.createElement(Q.a,{path:"/users"}," ",l.a.createElement(fe,null)," "),l.a.createElement(Q.a,{path:"/"}," ",l.a.createElement(h,null)," "))))},de=n(79),Ee=n(80),be=n(38),ve=Object(be.combineReducers)({notifications:M,blogs:W,login:L,users:F,comments:te}),ge=Object(be.createStore)(ve,Object(Ee.composeWithDevTools)(Object(be.applyMiddleware)(de.a)));u.a.render(l.a.createElement(i.a,{store:ge},l.a.createElement(pe,null)),document.getElementById("root"))},89:function(e,t,n){e.exports=n(117)}},[[89,1,2]]]);
//# sourceMappingURL=main.d0e5fc61.chunk.js.map