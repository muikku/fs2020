(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{119:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),l=n.n(c),o=n(12),u=n.n(o),i=n(10),s=n(18),m=n(158),p=n(120),f=n(159),d=n(121),E=n(160),b=n(161),v=n(162),g=n(163),h=n(154),O=function(){for(var e=[],t=0;t<6;t++)e.push(l.a.createElement("div",{key:t},l.a.createElement(h.a,{animation:"wave",height:80})));return l.a.createElement(l.a.Fragment,null,e)},w=function(){var e=Object(i.c)((function(e){return e.blogs}));return l.a.createElement(m.a,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:3},l.a.createElement(m.a,{container:!0,alignItems:"center",justify:"center",spacing:3},l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{variant:"h2"},"Blogs"))),l.a.createElement(m.a,{item:!0},e.length>=1?l.a.createElement(f.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(b.a,null,e.sort((function(e,t){return t.likes-e.likes})).map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,null,l.a.createElement(s.b,{to:"/blogs/".concat(e.id)},e.title," ")),l.a.createElement(g.a,null,e.author))}))))):l.a.createElement(O,null)))},y=n(7),j=n.n(y),k=n(13),S=n(24),x=n.n(S),I={login:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=null,C={getAll:function(){return x.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:T}},e.next=3,x.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return x.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){T="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:T}};return x.a.delete("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},resetToken:function(){return T=null},getComments:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("".concat("/api/blogs","/all/comments"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postComment:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("".concat("/api/blogs","/").concat(n,"/comments"),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},L={getAll:function(){return x.a.get("/api/users").then((function(e){return e.data}))},signIn:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(e,t,n,r){e({type:"ADD_MESSAGE",data:{message:t,severity:r||"success"}}),clearTimeout(a),a=setTimeout((function(){e({type:"CLEAR_MESSAGE"})}),1e3*(n||5))},A=function(e){return function(){var t=Object(k.a)(j.a.mark((function t(n){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I.login(e);case 3:a=t.sent,window.localStorage.setItem("loggedUser",JSON.stringify(a)),C.setToken(a.token),n({type:"LOGIN",data:a}),_(n,"welcome ".concat(a.name,"!")),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),_(n,"connection error while trying to login",5,"warning");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},G=function(e){return function(){var t=Object(k.a)(j.a.mark((function t(n){var a,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.signIn(e);case 3:return a=t.sent,t.next=6,I.login({username:e.username,password:e.password});case 6:r=t.sent,window.localStorage.setItem("loggedUser",JSON.stringify(r)),C.setToken(r.token),n({type:"LOGIN",data:r}),n({type:"ADD_USER",user:a}),_(n,"account created ".concat(e.name,"!")),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),_(n,"error: ".concat(t.t0.message),5,"warning");case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},D=n(164),M=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.login.name}));return l.a.createElement("em",null,t," logged in ",l.a.createElement(D.a,{variant:"outlined",color:"inherit",onClick:function(){e((function(e){window.localStorage.removeItem("loggedUser"),C.resetToken(),e({type:"LOGOUT"}),_(e,"logged out",5,"info")}))}},"logout"))},R=n(20),U=function(e,t,n){return function(a){a({type:"ADD_MESSAGE",data:{message:e,severity:n||"success"}}),clearTimeout(r),r=setTimeout((function(){a({type:"CLEAR_MESSAGE"})}),1e3*(t||5))}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_MESSAGE":return t.data;case"CLEAR_MESSAGE":return null;default:return e}},P=(n(8),n(165)),q=function(e){var t=Object(c.useState)(""),n=Object(R.a)(t,2),a=n[0],r=n[1];return{type:e,value:a,onChange:function(e){r(e.target.value)},onSubmit:function(){return r("")}}},J=n(181),z=n(167),F=n(168),K=n(178),W=n(170),Y=function(){var e=Object(i.b)(),t=q("text"),n=q("password"),a=Object(c.useState)(!1),r=Object(R.a)(a,2),o=r[0],u=r[1],s=function(){var a=Object(k.a)(j.a.mark((function a(r){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r.preventDefault();try{e(A({username:t.value,password:n.value})),t.onSubmit(),n.onSubmit()}catch(c){console.log(c),e(U("wrong username or password",5))}case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return l.a.createElement("div",null,l.a.createElement(D.a,{variant:"outlined",color:"inherit",onClick:function(){u(!0)}},"Login"),l.a.createElement(J.a,{open:o,onClose:function(){u(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(z.a,{id:"form-dialog-title"},"Login"),l.a.createElement(F.a,null,l.a.createElement("form",{onSubmit:s},l.a.createElement("div",null,l.a.createElement(K.a,{label:"username",inputProps:t,required:!0})),l.a.createElement("div",null,l.a.createElement(K.a,{label:"password",inputProps:n,required:!0})),l.a.createElement(W.a,null,l.a.createElement(D.a,{variant:"contained",id:"login-button",type:"submit"},"login"))))))},H=function(){var e=Object(i.b)(),t=q("text"),n=q("text"),a=q("password"),r=Object(c.useState)(!1),o=Object(R.a)(r,2),u=o[0],s=o[1],m=function(){var r=Object(k.a)(j.a.mark((function r(c){return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c.preventDefault();try{e(G({username:t.value,password:a.value,name:n.value})),t.onSubmit(),a.onSubmit(),n.onSubmit()}catch(l){e(U("an error while trying to sign in",5))}case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return l.a.createElement("div",null,l.a.createElement(D.a,{variant:"outlined",color:"inherit",onClick:function(){s(!0)}},"Sign In"),l.a.createElement(J.a,{open:u,onClose:function(){s(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(z.a,{id:"form-dialog-title"},"Login"),l.a.createElement(F.a,null,l.a.createElement("form",{onSubmit:m},l.a.createElement("div",null,l.a.createElement(K.a,{label:"name",inputProps:n,required:!0})),l.a.createElement("div",null,l.a.createElement(K.a,{label:"username",inputProps:t,required:!0})),l.a.createElement("div",null,l.a.createElement(K.a,{label:"password",inputProps:a,required:!0})),l.a.createElement(W.a,null,l.a.createElement(D.a,{variant:"contained",id:"login-button",type:"submit"},"sign in"))))))},Q=n(52),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return e.concat(t.data);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?t.data:e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));default:return e}},X=n(182),Z=n(33),$=function(){var e=Object(i.b)(),t=Object(Z.f)(),n=Object(i.c)((function(e){return e.login})),a=q("text"),r=q("text"),o=q("url"),u=Object(c.useState)(!1),s=Object(R.a)(u,2),m=s[0],p=s[1];return n?l.a.createElement("div",null,l.a.createElement(D.a,{color:"inherit",onClick:function(){return p(!0)}},"Create blog"),l.a.createElement(J.a,{open:m,onClose:function(){return p(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(z.a,{id:"form-dialog-title"},"Create blog"),l.a.createElement(F.a,null,l.a.createElement("form",{className:"formDiv",onSubmit:function(n){n.preventDefault();var c={title:a.value,author:r.value,url:o.value};e(function(e,t){return function(){var n=Object(k.a)(j.a.mark((function n(a){var r,c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.create(e);case 3:r=n.sent,a({type:"CREATE_BLOG",data:r}),c=r.user[0].username,a({type:"UPDATE_USER_BLOGS",blog:r,username:c}),_(a,"a new blog ".concat(r.title," by ").concat(r.author," added")),t.push("/blogs/".concat(r.id)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),_(a,"an error occured while posting blog ".concat(e.title),5,"error");case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(c,t)),p(!1)}},l.a.createElement("div",null,l.a.createElement(K.a,{label:"title",inputProps:a,required:!0})),l.a.createElement("div",null,l.a.createElement(K.a,{label:"author",inputProps:r,required:!0})),l.a.createElement("div",null,l.a.createElement(K.a,{label:"url",inputProps:o,required:!0})),l.a.createElement(W.a,null,l.a.createElement(D.a,{id:"blogSubmitButton",type:"submit"},"submit")))))):l.a.createElement(X.a,{title:"you must first login to create blogs"},l.a.createElement("span",null,l.a.createElement(D.a,{color:"inherit",onClick:function(){return e(U("login is required to create blogs",10,"info"))},disabled:!0},"Create blog")))},ee=n(171),te=n(172),ne=function(){var e=Object(i.c)((function(e){return e.login})),t=Object(P.a)((function(e){return{toolbar:e.mixins.toolbar}}))();return l.a.createElement("div",null,l.a.createElement("div",{className:t.toolbar}),l.a.createElement("div",{className:t.toolbar}),l.a.createElement(ee.a,{position:"fixed"},l.a.createElement(te.a,null,l.a.createElement(D.a,{color:"inherit",component:s.b,to:"/blogs"},"blogs"),l.a.createElement($,null),l.a.createElement(D.a,{color:"inherit",component:s.b,to:"/users"},"users"),e?l.a.createElement(M,null):l.a.createElement(l.a.Fragment,null,l.a.createElement(Y,null),l.a.createElement(H,null)))))},ae=function(){var e=Object(Z.g)().id,t=Object(i.c)((function(e){return e.users})).find((function(t){return t.id===e}));return t?l.a.createElement(m.a,{alignItems:"stretch",justify:"center",container:!0,direction:"column",spacing:3},l.a.createElement(m.a,{alignItems:"center",container:!0,justify:"center",direction:"column"},l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{variant:"h2"},t.name)),l.a.createElement(m.a,{item:!0},t.blogs.length<1?l.a.createElement(p.a,{variant:"h4"},"no blogs yet :/"):l.a.createElement(p.a,{variant:"h4"},"added blogs"))),l.a.createElement(m.a,{item:!0},l.a.createElement(f.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(b.a,null,t.blogs.map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,null,l.a.createElement(s.b,{to:"/blogs/".concat(e.id)},e.title," ")),l.a.createElement(g.a,null,l.a.createElement(p.a,null,e.likes," likes")))}))))))):null},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_COMMENTS":return t.comments;case"POST_COMMENT":return e.concat(t.comment);default:return e}},ce=function(e){var t=e.blog,n=q("text"),a=Object(i.c)((function(e){return e.comments.filter((function(e){return e.blogId===t.id}))})),r=Object(i.b)();return l.a.createElement("div",null,l.a.createElement(p.a,null,a.length," comments"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault();try{var a={comment:n.value};r((c=a,l=t.id,function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.postComment(c,l);case 3:n=e.sent,t({type:"POST_COMMENT",comment:n}),_(t,"comment added"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),_(t,"an error occured while posting comment",5,"error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),n.onSubmit()}catch(o){console.log(o)}var c,l}},l.a.createElement(K.a,{label:"add comment",inputProps:n})),a.map((function(e){return l.a.createElement(p.a,{key:e.id},e.comment)})))},le=n(173),oe=n(176),ue=n(174),ie=n(175),se=function(){var e=Object(Z.g)().id,t=Object(i.b)(),n=Object(Z.f)(),a=Object(i.c)((function(e){return e.blogs})),r=Object(i.c)((function(e){return e.login})),c=a.find((function(t){return t.id===e}));if(!c)return null;var o=c.user[0];return l.a.createElement(le.a,null,l.a.createElement(m.a,{container:!0,direction:"column",justify:"space-between",spacing:3},l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{variant:"h2"},c.title," ",c.author),l.a.createElement(p.a,null,"added by ",l.a.createElement(s.b,{to:"/users/".concat(o.id)},o.name," ")),l.a.createElement("a",{href:c.url},l.a.createElement(p.a,null,c.url))),l.a.createElement(m.a,{item:!0},l.a.createElement(m.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(D.a,{variant:"contained",startIcon:l.a.createElement(ue.a,null),color:"inherit",id:"blogLikeButton",onClick:function(){return t(function(e){return function(){var t=Object(k.a)(j.a.mark((function t(n){var a,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=Object(Q.a)({},e,{likes:e.likes+1}),t.next=4,C.update(e.id,a);case 4:r=t.sent,n({type:"LIKE_BLOG",data:a}),_(n,"liked ".concat(r.title,"!")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),_(n,"an error occured while liking blog ".concat(e.title),5,"error");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(c))}},c.likes," likes"),!r||!c.user||c.user.length>0&&r.username!==o.username?l.a.createElement(X.a,{title:"only owner can delete"},l.a.createElement("span",null,l.a.createElement(D.a,{variant:"outlined",startIcon:l.a.createElement(ie.a,null),disabled:!0},"Remove"))):l.a.createElement(D.a,{variant:"contained",startIcon:l.a.createElement(ie.a,null),onClick:function(){window.confirm("You are about to delete ".concat(c.title," by ").concat(c.author))&&(t(function(e){return function(){var t=Object(k.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.remove(e.id);case 3:n({type:"DELETE_BLOG",data:e.id}),_(n,"".concat(e.title," deleted!")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),_(n,"an error occured when deleting ".concat(e.title),5,"error");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(c)),n.push("/blogs"))}},"Remove"))),l.a.createElement(m.a,{item:!0},l.a.createElement(oe.a,{spacing:3})),l.a.createElement(m.a,{item:!0},l.a.createElement(ce,{blog:c}))))},me=n(179),pe=n(183),fe=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.notifications})),n=function(){e((function(e){e({type:"CLEAR_MESSAGE"})}))};return t?l.a.createElement(pe.a,{open:!0,onClose:n},l.a.createElement(me.a,{onClose:n,severity:t.severity},t&&l.a.createElement("div",{className:"error"},t.message))):null},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;case"UPDATE_USER_BLOGS":var n=e.find((function(e){return e.username===t.username})),a=n.blogs.concat(t.blog);return e.map((function(e){return e.username===t.username?Object(Q.a)({},n,{blogs:a}):e}));case"ADD_USER":return e.concat(t.user);default:return e}},Ee=n(177),be=function(){var e=Object(i.c)((function(e){return e.users}));return l.a.createElement(m.a,{alignItems:"stretch",justify:"center",container:!0,direction:"column",spacing:3},l.a.createElement(m.a,{alignItems:"center",container:!0,justify:"center",direction:"column"},l.a.createElement(m.a,{item:!0},l.a.createElement(p.a,{variant:"h2"},"Users"))),l.a.createElement(m.a,{item:!0},e.length>=1?l.a.createElement(f.a,{component:d.a},l.a.createElement(E.a,null,l.a.createElement(Ee.a,null,l.a.createElement(v.a,null,l.a.createElement(g.a,null,"user"),l.a.createElement(g.a,{align:"right"},"blogs created"))),l.a.createElement(b.a,null,e.map((function(e){return l.a.createElement(v.a,{key:e.id},l.a.createElement(g.a,{component:"th",scope:"row"},l.a.createElement(s.b,{to:"/users/".concat(e.id)},l.a.createElement(p.a,null,e.username))),l.a.createElement(g.a,{align:"right",scope:"row"},l.a.createElement(p.a,null,e.blogs.length)))}))))):l.a.createElement(O,null)))},ve=function(){var e=Object(i.b)();return Object(c.useEffect)((function(){e(function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getAll();case 3:n=e.sent,t({type:"INIT_BLOGS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_(t,"couldn't load blogs from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.getAll();case 3:n=e.sent,t({type:"INIT_USERS",data:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_(t,"couldn't load users from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getComments();case 3:n=e.sent,t({type:"INIT_COMMENTS",comments:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_(t,"couldn't load comments from server",5,"warning");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(c.useEffect)((function(){var t,n=window.localStorage.getItem("loggedUser");n&&e((t=n,function(e){var n=JSON.parse(t);C.setToken(n.token),e({type:"LOGIN",data:n})}))}),[e]),l.a.createElement(le.a,null,l.a.createElement(s.a,null,l.a.createElement(fe,null),l.a.createElement(ne,null),l.a.createElement(Z.c,null,l.a.createElement(Z.a,{path:"/blogs/:id"}," ",l.a.createElement(se,null)," "),l.a.createElement(Z.a,{path:"/blogs"}," ",l.a.createElement(w,null)," "),l.a.createElement(Z.a,{path:"/users/:id"}," ",l.a.createElement(ae,null)," "),l.a.createElement(Z.a,{path:"/users"}," ",l.a.createElement(be,null)," "),l.a.createElement(Z.a,{path:"/"}," ",l.a.createElement(w,null)," "))))},ge=n(79),he=n(80),Oe=n(38),we=Object(Oe.combineReducers)({notifications:B,blogs:V,login:N,users:de,comments:re}),ye=Object(Oe.createStore)(we,Object(he.composeWithDevTools)(Object(Oe.applyMiddleware)(ge.a)));u.a.render(l.a.createElement(i.a,{store:ye},l.a.createElement(ve,null)),document.getElementById("root"))},91:function(e,t,n){e.exports=n(119)}},[[91,1,2]]]);
//# sourceMappingURL=main.b1c7be4e.chunk.js.map